<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
<h:head>
    <title>Tienda Online - Productos</title>
    <h:outputStylesheet name="css/style.css"/>
</h:head>
<h:body>
    <div class="container">
        <div class="header">
            <h1>ðŸ›’ Tienda Online</h1>
            <div class="nav">
                <h:link value="Productos" outcome="index" styleClass="nav-link"/>
                <h:link value="GestiÃ³n de Productos" outcome="gestion" styleClass="nav-link"/>
                <h:link value="Ver Carrito" outcome="carrito" styleClass="nav-link cart-link">
                    <f:param name="items" value="#{cartBean.cantidadItems}"/>
                </h:link>
                <span class="cart-count">#{cartBean.cantidadItems} items</span>
            </div>
        </div>
        
        <h:messages globalOnly="true" styleClass="messages" infoClass="info" errorClass="error" warnClass="warn"/>
        
        <h2>CatÃ¡logo de Productos</h2>
        
        <h:form id="productosForm">
            <div class="product-grid">
                <ui:repeat value="#{productBean.productos}" var="producto">
                    <div class="product-card">
                        <h3>#{producto.nombre}</h3>
                        <p class="descripcion">#{producto.descripcion}</p>
                        <p class="precio">$<h:outputText value="#{producto.precio}">
                            <f:convertNumber type="number" maxFractionDigits="2" minFractionDigits="2"/>
                        </h:outputText></p>
                        <p class="stock">
                            Stock: #{producto.stock} unidades
                            <span class="stock-badge #{producto.stock > 10 ? 'stock-ok' : producto.stock > 0 ? 'stock-low' : 'stock-out'}">
                                #{producto.stock > 10 ? 'Disponible' : producto.stock > 0 ? 'Poco stock' : 'Agotado'}
                            </span>
                        </p>
                        <h:commandButton value="Agregar al Carrito" 
                                       action="#{cartBean.agregarAlCarrito(producto)}"
                                       styleClass="btn btn-primary"
                                       disabled="#{producto.stock == 0}">
                            <f:ajax execute="@form" render="@form :headerForm"/>
                        </h:commandButton>
                    </div>
                </ui:repeat>
            </div>
        </h:form>
        
        <div class="footer">
            <p>Â© 2025 Tienda Online - Todos los derechos reservados</p>
        </div>
    </div>
</h:body>
</html>
